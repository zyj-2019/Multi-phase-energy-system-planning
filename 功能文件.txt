功能文件 (Functionality List)
==============================

本文档总结了当前 MATLAB 能源系统优化模型的已实现功能和待开发功能。

一、 已实现功能 (Implemented Features)
---------------------------------------

* **1. 确定性单阶段联合优化:**
    * 实现了基于确定性输入（负荷、风光潜力、价格）的单阶段优化框架。
    * 同时优化了系统设备的容量配置（Capacity Planning）和代表性周期内的运行调度（Operational Scheduling）。

* **2. 综合能源系统建模:**
    * 包含了多种能源技术的详细模型：
        * 发电：燃气轮机 (CCGT)、光伏 (PV)、风电 (WT)。
        * 供热：燃气锅炉 (EBg)、燃气吸收式热泵 (HPg)、电锅炉 (EBe)、电热泵 (HPe)。
        * 储能：电储能 (ESS)、热储能 (TES)。
        * 电网交互：购电、售电（可选）。
    * 考虑了各种设备的技术参数（效率、容量、爬坡率、最小负荷、寿命等）和经济参数（投资、运维、燃料、碳价、电价等）。

* **3. 经济性最优目标:**
    * 以最小化系统的**年化总成本**为优化目标。
    * 成本构成包括：年化投资成本 (CAPEX)、固定和可变运维成本 (OPEX)、燃料成本、爬坡成本、启停成本、净电网交互成本、碳排放成本（超额排放部分）以及弃风弃光惩罚成本。

* **4. 详细运行约束:**
    * 实施了严格的电功率和热功率平衡约束。
    * 包含了各设备的操作约束：运行上下限、爬坡速率限制、储能状态（SOC/SOT）转移方程及上下限、储能周期性约束。
    * 实现了基本的启停逻辑和最小运行/停机时间约束。

* **5. 变时间分辨率处理:**
    * 模型能够处理输入数据中的变时间分辨率 (`t_resolution`)。
    * 成本计算、状态转移、爬坡约束等均考虑了时间步长的变化。
    * 实现了将固定时长的开关决策映射到变时间步上的机制。

* **6. 优化求解与结果处理:**
    * 使用 YALMIP 作为建模语言，可调用 Gurobi 等优化求解器。
    * 实现了对求解结果的提取和基本处理。
    * 包括了结果可视化功能，可绘制功率平衡图、储能状态图、可再生能源利用图和设备配置图。
    * 可将关键结果导出到 Excel 文件。

二、 未实现/待开发功能 (Unimplemented / To-Do Features)
--------------------------------------------------

* **1. 不确定性处理 (核心差距):**
    * **风光出力不确定性：** 未考虑风能和光伏出力的随机性、波动性和预测误差。
    * **价格不确定性：** 未考虑油价（如果影响天然气价格）和碳价在长期内的多种增长可能性（如不变、适中增长、快速增长三种模式）。
    * **缺少鲁棒性方法：** 未集成鲁棒优化（RO）、分布鲁棒优化（DRO）或随机规划（SP）等方法来应对上述不确定性，以提高规划方案的鲁棒性。

* **2. 多阶段长期规划框架 (核心差距):**
    * 当前为单阶段模型，缺乏对整个长期规划时域（如 2026-2060年）的**分阶段**决策建模。
    * 未考虑设备在不同阶段的退役、替换和新增投资的**时序决策**。
    * 需要建立能够反映系统状态（如设备年龄、累计排放等）在阶段间演化的模型结构。

* **3. 中短期滚动优化机制 (核心差距):**
    * 缺乏在长期规划指导下的**滚动优化**机制，以利用更新的短期预测信息进行更精细的运行调度优化。
    * 需要设计长期规划与滚动优化之间的信息交互接口。

* **4. 模型目标与结构的适应性调整:**
    * 引入不确定性和多阶段后，需要相应调整目标函数（如考虑期望成本、最差情况成本或多年总折现成本）和约束（如鲁棒对应约束）。
    * 变量定义需要扩展以包含阶段、场景或不确定性维度。

* **5. 长期与不确定性数据集成:**
    * 需要获取并集成用于不确定性建模的数据（如风光历史数据、价格情景数据）以及覆盖长期规划周期的数据。